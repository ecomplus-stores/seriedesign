!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("@ecomplus/utils"),require("@ecomplus/passport-client")):"function"==typeof define&&define.amd?define([,],t):"object"==typeof exports?exports.widgetEbit=t(require("@ecomplus/utils"),require("@ecomplus/passport-client")):e.widgetEbit=t(e.ecomUtils,e.EcomPassport)}(window,(function(e,t){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="/assets/vendor/",r(r.s=2)}([function(t,r){t.exports=e},function(e,r){e.exports=t},function(e,t,r){"use strict";r.r(t);var n=r(0),o=r(1),a=r.n(o);t.default=(e={})=>{const{ebitStoreId:t}=e;if(t){const e=window.storefrontApp&&window.storefrontApp.router;if(e){let r=0;const o=({name:e,params:o})=>{"confirmation"===e&&0===r&&(r++,a.a.fetchOrder(o.id).then(e=>{const r=a.a.getCustomer();let o=`storeId=${t}&mktSaleId=0&platform=ecomplus&totalSpent=`+e.amount.total+"&deliveryTax="+(e.amount.freight||0)+"&transactionId="+(e.number||e._id)+"&email="+r.main_email;if(r.gender&&(o+="&gender="+r.gender.toUpperCase()),r.birth_date){const{day:e,month:t,year:n}=r.birth_date;o+="&birthday="+e.toString().padStart(2,"0")+`-${t.toString().padStart(2,"0")}-${n}`}const{items:i}=e;if(i&&i.length){let e=i[0].sku,t=Object(n.price)(i[0]),r=i[0].quantity,a=encodeURIComponent(i[0].name);for(let o=1;o<i.length;o++)e+="|"+i[o].sku,t+="|"+Object(n.price)(i[o]),r+="|"+i[o].quantity,a+="|"+encodeURIComponent(i[o].name);o+=`&sku=${e}&value=${t}&quantity=${r}&productName=${a}`}if(e.shipping_lines&&e.shipping_lines[0]){const t=e.shipping_lines[0];o+="&deliveryTime="+(t.delivery_time.days||0)+"&zipCode="+t.to.zip}if(e.transactions&&e.transactions[0]){const t=e.transactions[0];switch(o+="&parcels="+(t.installments&&t.installments.number||1),o+="&paymentType=",t.payment_method.code){case"credit_card":o+="05";break;case"banking_billet":o+="08";break;case"debit_card":case"online_debit":case"account_deposit":o+="28";break;case"loyalty_points":o+="24";break;default:o+="14"}if(t.credit_card&&t.credit_card.company)switch(o+="&cardFlag=",t.credit_card.company.toLowerCase()){case"visa":o+=6;break;case"mastercard":o+=5;break;case"american express":case"amex":o+=1;break;case"elo":o+=8;break;case"aura":o+=2;break;case"hipercard":o+=4;break;case"diners club":o+=3;break;default:o+=7}}const c=setInterval(()=>{const e=document.getElementById("confirmation");if(e){e.insertAdjacentHTML("beforeend",`<div> <param id="ebitParam" value="${o}"> <a id="bannerEbit"></a> </div>`);const r=document.createElement("script");r.id="getSelo",r.type="text/javascript",r.src=`https://imgs.ebit.com.br/ebitBR/selo-ebit/js/getSelo.js?${t}&lightbox=true`,document.body.appendChild(r),clearInterval(c)}},200)}).catch(console.error))};e.currentRoute&&o(e.currentRoute),e.afterEach(o)}}else console.error(new Error("Can't show lightbox without `ebitStoreId` option"))}}]).default}));
//# sourceMappingURL=widget-ebit.min.js.map
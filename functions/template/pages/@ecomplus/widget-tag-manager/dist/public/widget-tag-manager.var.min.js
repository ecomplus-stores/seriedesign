var widgetTagManager=function(e){var t={};function o(n){if(t[n])return t[n].exports;var r=t[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,o),r.l=!0,r.exports}return o.m=e,o.c=t,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)o.d(n,r,function(t){return e[t]}.bind(null,r));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="/assets/vendor/",o(o.s=2)}([function(e,t){e.exports=void 0},function(e,t){e.exports=void 0},function(e,t,o){"use strict";o.r(t);var n=o(1);const r=n.$ecomConfig.get("currency")||"BRL",c=e=>{const t={name:Object(n.name)(e),id:e.sku,price:Object(n.price)(e).toFixed(2)};return e.quantity&&(t.quantity=e.quantity),t};var a=o(0),s=o.n(a);t.default=(e={})=>{const{dataLayerVar:t,parseDomMsDelay:o}=e,a=window[t]||window.dataLayer;a&&((e=>{const t=window.storefront&&window.storefront.context;if(t&&"products"===t.resource){const{body:o}=t,a=c(o),s={event:"eec.detail",ecommerce:{currencyCode:r,detail:{products:[a]}}},i=Object(n.categoriesList)(o);i.length&&(a.category=o.category_tree?o.category_tree.replace(/\s>\s/g,"/"):i[0],s.ecommerce.detail.actionField={list:i[0]}),o.brands&&o.brands.length&&(a.brand=o.brands[0].name),e.push(s)}})(a),(e=>{const t=window.storefrontApp&&window.storefrontApp.router;if(t){let o,n,a;const i=()=>{const e=[];return s.a.data&&Array.isArray(s.a.data.items)&&s.a.data.items.forEach(t=>{e.push(c(t))}),e},u=t=>{e.push({event:"eec.checkout_option",ecommerce:{currencyCode:r,checkout_option:{actionField:t}}})},d=(t,c)=>{const a={step:t,option:c};t<=1||!o?(e.push({event:"eec.checkout",ecommerce:{currencyCode:r,checkout:{actionField:a,products:i()}}}),e.push({event:"checkout"}),o=!0):n||(u(a),e.push({event:"checkoutOption"}),n=!0)},p=(t,o)=>{if(!a){const{amount:n}=window.storefrontApp,c={id:t,revenue:(n&&n.total||s.a.data&&s.a.data.subtotal||0).toFixed(2)};let d;if(n&&(void 0!==n.freight&&(c.shipping=n.freight.toFixed(2)),void 0!==n.tax&&(c.tax=n.tax.toFixed(2))),o)try{d=JSON.parse(o)}catch(e){}d&&(["payment_method_label","shipping_method_label"].forEach((e,t)=>{d[e]&&u({step:3+t,option:d[e]})}),d.extra_discount&&d.extra_discount.discount_coupon&&(c.coupon=d.extra_discount.discount_coupon)),e.push({event:"eec.purchase",ecommerce:{currencyCode:r,purchase:{actionField:c,products:i()}}}),a=!0}};let l;const m=({name:e,params:t})=>{switch(e){case"cart":d(1,"Review Cart");break;case"checkout":d(2,"Confirm Purchase");break;case"confirmation":clearTimeout(l),t.json?p(t.id,decodeURIComponent(t.json)):l=setTimeout(()=>{p(t.id)},1500)}};t.currentRoute&&m(t.currentRoute),t.afterEach(m)}})(a),(e=>{const t={},o=o=>{const n=c(o);e.push({event:"eec.add",ecommerce:{currencyCode:r,add:{products:[n]}}}),e.push({event:"addToCart"}),t[o.sku]=n},n=o=>{const n=t[o.sku];e.push({event:"eec.remove",ecommerce:{currencyCode:r,remove:{products:[n?Object.assign({},n):c(o)]}}}),e.push({event:"removeFromCart"}),delete t[o.sku]};s.a.on("addItem",({item:e})=>o(e)),s.a.on("increaseItemQnt",({item:e})=>{const r=t[e.sku];if(r){const t=e.quantity-r.quantity;t>0?o({...e,quantity:t}):n({...e,quantity:-t})}else o(e)}),s.a.on("removeItem",({item:e})=>n(e)),s.a.on("clear",()=>{for(const e in t)t[e]&&n(t[e])})})(a),setTimeout(()=>{(e=>{const t=document.querySelectorAll("[data-sku]");if(t.length){const o=[],n={},c="/search"===window.location.pathname;for(let e=0;e<t.length;e++){const r=t[e],{sku:a}=r.dataset;if(-1===o.indexOf(a)&&(o.push(a),r.closest)){const e=r.closest(".products-carousel");!c&&e&&(n[a]=e.dataset.title)}}e.push({event:"eec.impressions",ecommerce:{currencyCode:r,impressions:o.map(e=>{const t=c?"Search results":n[e],o={id:e};return t&&(o.list=t),o})}})}})(a)},o>=0?o:300))}}]).default;
//# sourceMappingURL=widget-tag-manager.var.min.js.map